//a,b,c
//
//
//a=1 and c=2
//a =1 and b < 100
//a =1 and b < 100 and c =3
//


# Mysql


#### Mysql 索引最左前缀匹配原则
| 条件（示例）                            | 可用索引前缀                                   | c 是否还能参与定位 | 访问说明                                       |
| --------------------------------- | ---------------------------------------- | ---------- | ------------------------------------------ |
| `a = ?`                           | `(a)`                                    | 取决于 b,c 条件 | 若 b=`=`/`IN`，还能推进；若 b=R 截断                 |
| `a = ? AND b = ?`                 | `(a,b)`                                  | 取决于 c 条件   | c=`=`/`IN`/`R` 均可（若 c=R，此处为**首个范围**，之后无列了） |
| `a = ? AND b IN (...)`            | `(a,b)`                                  | c 仍可用      | `IN` 不截断，c 可 `=`/`IN`/`R`                  |
| `a IN (...) AND b = ?`            | `(a,b)`                                  | c 仍可用      | 同上                                         |
| `a IN (...) AND b IN (...)`       | `(a,b)`                                  | c 仍可用      | 仍可到 c，且 c 可 `=`/`IN`/`R`                   |
| `a = ? AND b BETWEEN x AND y`     | `(a,b)`                                  | **不能**     | b 是首个范围，**截断**                             |
| `a = ? AND b LIKE 'pre%'`         | `(a,b)`                                  | **不能**     | 同上                                         |
| `a BETWEEN x AND y`               | `(a)`                                    | **不能**     | a 是首个范围，**截断**                             |
| `a LIKE 'pre%'`                   | `(a)`                                    | **不能**     | 同上                                         |
| `a = ? AND b = ? AND c = ?`       | `(a,b,c)`                                | 已用尽        | 三列全等值，最优                                   |
| `a = ? AND c = ?`（缺 b）            | `(a)`                                    | 不行         | 中间断层，**不能直接跳到 c**；c 只能 ICP 过滤              |
| `b = ?`（缺 a）                      | 5.7：通常不用 `idx_abc` ；8.0：**可用 Skip Scan** | 取决         | 见下节“缺左列”                                   |
| `a IS NULL AND b = ?`             | `(a,b)`                                  | 可用         | `IS NULL` 视作等值                             |
| `a <> ?` 或 `a != ?`               | 通常不走前缀                                   | 否          | 往往全表/索引扫描过滤                                |
| `a = ? AND b = ? AND c > ?`       | `(a,b,c)`                                | 用作范围       | 经典：等值链后一个范围                                |
| `a = ? AND b > ? AND c = ?`       | `(a,b)`                                  | **不能**     | 在 b 处已范围，c 仅 ICP 过滤                        |
| `a = ? AND b = ? AND c LIKE '%x'` | `(a,b)`                                  | **不能**     | 前导通配，不能用于定位                                |
| `a = ? AND FUNC(b) = ?`           | `(a)`                                    | **不能**     | 对列做函数，b 失去索引利用                             |
| `CAST(a AS CHAR)= '1'`            | 否                                        | 否          | 类型转换使索引失效                                  |
| `a IN (subquery)`                 | 视子查询是否可物化为常量集合                           | 取决         | 可物化则等同 `IN (...)`                          |
